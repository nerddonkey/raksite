<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="jemdoc.css" type="text/css" />
<link rel="stylesheet" href="web-mods.css" type="text/css" />
<title>rakdoc</title>
<!-- mathjax -->
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
      type="text/javascript">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script><!-- apple-touch-icon -->
<link rel="apple-touch-icon"
      href="img/icon-60.png">
<link rel="apple-touch-icon"
      sizes="76x76" href="img/icon-76.png">
<link rel="apple-touch-icon"
      sizes="120x120" href="img/icon-120.png">
<link rel="apple-touch-icon"
      sizes="152x152" href="img/icon-152.png">
<!-- iPhone -->
<link rel="apple-touch-startup-image"
      media="(device-width: 320px)"
      href="img/apple-touch-startup-image-320x460.png">
<!-- iPhone (Retina) -->
<link rel="apple-touch-startup-image"
      media="(device-width: 320px)
         and (-webkit-device-pixel-ratio: 2)"
      href="img/apple-touch-startup-image-640x920.png">
</head>
<body>
<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-menu">
<div class="menu-category">Main</div>
<div class="menu-item"><a href="index.html">Home</a></div>
<div class="menu-item"><a href="contact.html">Contact</a></div>
<div class="menu-item"><a href="book.html">Book</a></div>
<div class="menu-item"><a href="links.html">Links</a></div>
<div class="menu-category">Research</div>
<div class="menu-item"><a href="students.html">Students</a></div>
<div class="menu-item"><a href="pubs.html">Publications</a></div>
<div class="menu-item"><a href="trivia.html">Trivia</a></div>
<div class="menu-category">Courses</div>
<div class="menu-item"><a href="http://programsandcourses.anu.edu.au/course/ENGN2228">ENGN2228</a></div>
<div class="menu-item"><a href="http://programsandcourses.anu.edu.au/course/ENGN8538">ENGN8538</a></div>
<div class="menu-category">Study</div>
<div class="menu-item"><a href="phd.html">PhD</a></div>
<div class="menu-item"><a href="masters.html">Masters</a></div>
<div class="menu-category">Misc</div>
<div class="menu-item"><a href="rakdoc.html" class="current">rakdoc</a></div>
</td>
<td id="layout-content">
<h1>Setting Up <tt>jemdoc/rakdoc</tt> to Run Under <tt>TeXShop</tt></h1>
<h2>Glossary of Terms</h2>
<table id="glossary">
<tr class="r1"><td class="c1">Item </td><td class="c2"> Description </td><td class="c3"> Link </td></tr>
<tr class="r2"><td class="c1"><tt>jemdoc</tt> </td><td class="c2"> simplified human readable markup language </td><td class="c3"> <a href="http://jemdoc.jaboc.net/index.html" target="_blank"><tt>jemdoc</tt> homepage</a> </td></tr>
<tr class="r3"><td class="c1"><tt>TeXShop</tt> </td><td class="c2"> <tt>TeX</tt> previewer for Mac OS X </td><td class="c3"> <a href="http://pages.uoregon.edu/koch/texshop/" target="_blank"><tt>TeXShop</tt> homepage</a> </td></tr>
<tr class="r4"><td class="c1"><tt>python</tt> </td><td class="c2"> programming and scripting language </td><td class="c3"> <a href="https://www.python.org" target="_blank">python homepage</a> </td></tr>
<tr class="r5"><td class="c1"><tt>TeXShop</tt> metadata </td><td class="c2"> metadata for typesetting directives </td><td class="c3"> <a href="http://tex.stackexchange.com/questions/78101/" target="_blank">metadata page</a> </td></tr>
<tr class="r6"><td class="c1"><tt>css</tt> </td><td class="c2"> cascading style sheets for web appearance and layout </td><td class="c3"> <a href="http://en.wikipedia.org/wiki/Cascading_Style_Sheets" target="_blank">css wikipedia entry</a>
</td></tr></table>
<h2>Big Picture</h2>
<p><a href="http://jemdoc.jaboc.net/index.html" target="_blank"><tt>jemdoc</tt></a> is simplified human readable markup language that can be used to make webpages and websites.  To generate <tt>html</tt> one converts a plain-text file written in <tt>jemdoc</tt> using a <a href="https://www.python.org" target="_blank">python</a> program called <tt>jemdoc.py</tt>.  I hacked <tt>jemdoc</tt> to add minor additional functionality and this is called <a href="css-etc/rakdoc.py.zip" target="_blank"><tt>rakdoc</tt></a>.  With the following I describe how to make life very easy to create webpages and a website using <tt>rakdoc</tt>, or equally well with <tt>jemdoc</tt>. For what it is worth the output viewed in a browser looks very nice given a carefully designed <tt>css</tt> style sheet. If you don't use OS X then you're out of luck.</p>
<p>The big picture is doing <tt>html</tt> is pretty brain-dead and tedious.  As a language it is pretty ordinary to say the least. I only ever want to update web pages every so often and working with <tt>html</tt> (and <tt>css</tt>) is something to avoid.  People realised that it is better to work with a greatly simplified plain-text human readable markup language/short-hand and have this converted to <tt>html</tt>.  This is achieved by running the simplified markup through a program (here <tt>jemdoc</tt> or <tt>rakdoc</tt>) and the output is <tt>html</tt>, which can be displayed in a browser.  This program is expected to be run through the <tt>Terminal</tt> (command line) but this is very nerdy and is best avoided.</p>
<p>As an academic I'm use to writing <tt>LaTeX</tt> technical papers (containing mathematics), where a plain-text source file is compiled or typeset and a PDF file is output and displayed. I focus on content; typeset, and read/admire the final output; then modify content and repeat.  For web-page creation I want the same thing.  In fact I want to use the same program, which is <a href="http://pages.uoregon.edu/koch/texshop/" target="_blank"><tt>TeXShop</tt></a>.  If I edit a <tt>LaTeX</tt> document in <tt>TeXShop</tt> then when I &ldquo;<tt>Typeset</tt>&rdquo; I see a PDF file in the &ldquo;<tt>Preview</tt>&rdquo; window (in <tt>TeXShop</tt>).  Now I want to edit a <tt>jemdoc</tt> document in <tt>TeXShop</tt> then when I &ldquo;<tt>Typeset</tt>&rdquo; I expect to get a <tt>html</tt> file with my web browser providing the &ldquo;<tt>Preview</tt>&rdquo;.</p>
<h2>Summary</h2>
<p>The scenario is:</p>
<ol>
<li><p>some file <tt>filename.jemdoc</tt> is double clicked in the <tt>Finder</tt></p>
</li>
<li><p>this launches <tt>TeXShop</tt> and the plain-text <tt>jemdoc</tt> file opens and can be edited as normal</p>
</li>
<li><p>the file, even though it is not a <tt>LaTeX</tt> file, can be &ldquo;<tt>Typeset</tt>&rdquo; (command-T) within <tt>TeXShop</tt></p>
<ol>
<li><p>an <tt>html</tt> file called &ldquo;<tt>filename.html</tt>&rdquo; is (re-)generated in the subfolder <tt>html/</tt> (which is created if necessary)</p>
</li>
<li><p>the output &ldquo;<tt>html/filename.html</tt>&rdquo; is opened automatically in the user's default browser (usually <tt>Safari</tt>), which is the &ldquo;<tt>Preview</tt>&rdquo; functionality</p>
</li>
</ol>

</li>
</ol>
<p>Follow this link to see a short screen capture movie of this in action: <a href="media/example-desktop.mov" target="_blank">movie</a></p>
<h2>Installing the Executable Python Script <tt>rakdoc</tt> (or Other Program)</h2>
<p>Installation is as follows (modelled after <a href="http://jemdoc.jaboc.net/download.html" target="_blank">jemdoc install</a>):</p>
<div class="codeblock">
<div class="blockcontent"><pre>
sudo cp rakdoc.py /usr/bin/rakdoc
cd /usr/bin
sudo chmod +x rakdoc
</pre></div></div>
<p>This puts an executable called <tt>rakdoc</tt> (which has been stripped of the file extension) in a place where it can be executed from anywhere (it should be in the standard <tt>PATH</tt>).  As a <tt>python</tt> script <tt>rakdoc</tt> is normally run from the <tt>Terminal</tt> app.  To check you have installed it correctly from any directory type the command <tt>rakdoc</tt> or <tt>rakdoc &ndash;show-config</tt> in <tt>Terminal</tt>.</p>
<h2>Configuring <tt>TeXShop</tt></h2>
<p><tt>TeXShop</tt> is designed for <tt>LaTeX</tt> and most engines to do things related to TeX, LaTeX, XeTeX, etc.  However we can add an engine that runs <tt>rakdoc</tt> on a <tt>jemdoc</tt> file that is open in <tt>TeXShop</tt>.  This engine is a bash shell that runs &ldquo;<tt>rakdoc</tt>&rdquo; at the command line level for you and does a few other things.  This engine is called <a href="css-etc/rakdoc.engine.zip" target="_blank"><tt>rakdoc.engine</tt></a> and one version of it can be seen further down the page.</p>
<ul>
<li><p>To install the engine <tt>rakdoc.engine</tt> do something like:</p>
</li>
</ul>
<div class="codeblock">
<div class="blockcontent"><pre>
sudo cp rakdoc.engine ~/Library/TeXShop/Engines
cd ~/Library/TeXShop/Engines
sudo chmod +x rakdoc.engine
</pre></div></div>
<ul>
<li><p>Now when <tt>TeXShop</tt> is (re-)launched you'll find <tt>rakdoc</tt> available as an alternative command to the usual <tt>LaTeX</tt> and other built-in commands (in the <tt>Program</tt> pulldown menu).  Of course if you run it, by invoking <tt>Typeset</tt> (command-T), on a <tt>LaTeX</tt> file you'll get nonsense and errors; because the engine is expecting a <tt>rakdoc</tt> file not a <tt>LaTeX</tt> file.</p>
</li>
<li><p>If you open a <tt>jemdoc</tt> file in <tt>TeXShop</tt> you'll find you can't typeset it because the <tt>Typeset</tt> command is dimmed and deactivated.  This is because the file extension <tt>jemdoc</tt> is not one that <tt>TeXShop</tt> by default recognizes.  To add <tt>jemdoc</tt> to the extensions or file types <tt>TeXShop</tt> recognizes go to <tt>Terminal</tt> and copy the following (and hit return):</p>
</li>
</ul>
<div class="codeblock">
<div class="blockcontent"><pre>
defaults write TeXShop OtherTeXExtensions -array-add "jemdoc"
</pre></div></div>
<ul>
<li><p>Relaunch <tt>TeXShop</tt> and open the <tt>jemdoc</tt> file &#8201;&mdash;&#8201; this time the <tt>Typeset</tt> command should be activated.</p>
</li>
<li><p>Select the <tt>rakdoc</tt> command before typesetting and it should all work.  But we can improve things to make life easier.</p>
</li>
<li><p>Whenever a <tt>jemdoc</tt> file is opened in <tt>TeXShop</tt> the default command, usually <tt>LaTeX</tt>, is selected.  Whilst this default can be changed in the preferences it isn't a good idea because most of the time you'll be typesetting <tt>LaTeX</tt> documents in <tt>TeXShop</tt>.  You can of course each time select the <tt>rakdoc</tt> command before typesetting but this can be annoying.  The trick is to include <a href="http://tex.stackexchange.com/questions/78101/" target="_blank">metadata</a> near the top of your <tt>jemdoc</tt> file that instructs <tt>TeXShop</tt> to use the <tt>rakdoc</tt> command when typesetting &#8201;&mdash;&#8201; this is shown in the second line in what is shown below:</p>
</li>
</ul>
<div class="codeblock">
<div class="blockcontent"><pre>
# jemdoc: title{Whatever}, menu{myMenu}{index.html}
#% !TEX TS-program = rakdoc
</pre></div></div>
<ul>
<li><p>This metadata, which concatenates two types of commenting conventions, mercifully works.  The <tt>TeXShop</tt> metadata begins with <tt></tt>+ because this is a +LaTeX+ comment (and won't upset the actual +LaTeX+ code).
However, +<tt></tt> upsets jemdoc because it isn't interpreted as a comment &#8201;&mdash;&#8201; that is why it is prefixed with <tt>#</tt>, which is the jemdoc Python-style single line comment.</p>
</li>
<li><p>This finalizes what we need to do in <tt>TeXShop</tt> and in each <tt>jemdoc</tt> file.</p>
</li>
</ul>
<h2>Configuring <tt>Finder</tt></h2>
<p>If you double-click a <tt>jemdoc</tt> file in the <tt>Finder</tt> it won't automatically open the file in <tt>TeXShop</tt> but use a default app (usually <tt>TextEdit</tt>).  To have <tt>TeXShop</tt> used instead as default is simple:</p>
<ul>
<li><p>In <tt>Finder</tt> do a <tt>Get Info</tt> (Command-I) on the <tt>jemdoc</tt> file. Set the pull-down menu "<tt>Open with:</tt> to <tt>TeXShop</tt>, and hit the <tt>Change All&hellip;</tt> button and select <tt>Continue</tt> in the dialog box.



</p>
</li>
</ul>
<h2>rakdoc.engine Inner Workings</h2>
<div class="codeblock">
<div class="blockcontent"><pre>
#!/bin/bash
echo -e "This is rakdoc bash engine, Version 1.2, feel deeply privileged\n"

filename="$1"
htmlname="${filename%.*}.html"
destdir="html/"
CONF="mysite.conf"
imgdir="html/img/"

echo -e "rakdoc Info: Source jemdoc file:" $filename

# run rakdoc
if [ -f $CONF ];
then
	echo -e "rakdoc Info: Using configuration file '$CONF'."
	rakdoc -c $CONF "$filename"
else
	echo -e "rakdoc Warning: No configuration file '$CONF' found."
	rakdoc "$filename"
fi

# create html/ and html/img if they don't exist
mkdir -p $imgdir
mv "$htmlname" $destdir
htmlname=$destdir$htmlname
echo -e "rakdoc Info: Destination html file:" $htmlname

# open the html in the user's default browser
open "$htmlname"

echo -e "\n...rakdoc has left the building."
</pre></div></div>
<div id="footer">
<div id="footer-text">
Page generated 2015-05-04 23:23:43 AEST, by <a href="http://jemdoc.jaboc.net/">jemdoc</a>.
</div>
</div>
</td>
</tr>
</table>
</body>
</html>
