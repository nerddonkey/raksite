<!DOCTYPE html>
<html lang="en-us">

  	<head>
		<link href="http://gmpg.org/xfn/11" rel="profile">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<!-- Enable responsiveness on mobile devices-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

		<title>
			Kennedy &middot; Spherical Harmonic Plotting with MATLAB&reg;
		</title>

		<!-- CSS -->
		<link rel="stylesheet" href="/rod/public/css/poole-rak.css">
		<link rel="stylesheet" href="/rod/public/css/syntax.css">
		<link rel="stylesheet" href="/rod/public/css/lanyon-rak.css">
		<link rel="stylesheet" href="/rod/public/css/bibdesk-export.css">
		<link rel="stylesheet" href="/rod/public/css/raksite.css">

		<!-- External CSS -->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

		<!-- Icons -->
		<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/rod/public/apple-touch-icon-precomposed.png">
		<link rel="shortcut icon" href="/rod/public/favicon.ico">

		<!-- javascript -->
		
		<script type="text/javascript">
			window.onload = function() {
				var links = document.links;
				for (var i = 0, linksLength = links.length; i < linksLength; i++) {
					if (links[i].hostname != window.location.hostname) {
						links[i].target = '_blank';
					}
				}
			}
		</script>
		<script type="text/javascript">
			function toggle(id) {
				e = document.getElementById(id);
				if (e.style.display == "none")
					e.style.display = "inline";
				else
					e.style.display = "none";
			}
		</script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script>
			if (typeof jQuery == 'undefined') {
				document.write(unescape("%3Cscript src='public/js/jquery-1.11.3.js' type='text/javascript'%3E%3C/script%3E"));
		  	}
		</script>
		<script>
			$(document).ready(function() {
				$("#hide-bibtex").click(function() {
					$(".Bibtex-toggle").hide();
				});
				$("#show-bibtex").click(function() {
					$(".Bibtex-toggle").show();
				});
				$("#hide-abstract").click(function() {
					$(".Abstract-toggle").hide();
				});
				$("#show-abstract").click(function() {
					$(".Abstract-toggle").show();
				});
			});
		</script>

		<!-- fontawesome: icon font -->
		<script src="https://use.fontawesome.com/53cb97c394.js"></script>

		<!-- mathjax enable latex math with equation numbers $$\begin{equation} ... \end{equation}$$ kramdown syntax -->
		<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"></script>
		<script type="text/x-mathjax-config">
			MathJax.Hub.Config({
				TeX: {
					equationNumbers: { autoNumber: "AMS" },
					extensions: ["color.js"] },
				SVG: {
					scale: 90, blacker: 20 } });
		</script>
	</head>


  <body class="theme-base-0b sidebar-overlay">

    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
   <div class="sidebar-item">
      Website of<br><b>Prof Rodney A. Kennedy</b><i class="fa fa-cog fa-spin fa-1x fa-fw"></i>
   </div>

   <nav class="sidebar-nav">
      <a class="sidebar-nav-item "
         href="/rod/index.html"><i class="fa fa-institution fa-fw" aria-hidden="true"></i>&nbsp; Home Page</a>
      <a class="sidebar-nav-item"
         href="/rod/contact.html"><i class="fa fa-user fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Contact</a>
      <a class="sidebar-nav-item"
         href="/rod/students.html"><i class="fa fa-graduation-cap fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;PhD Students</a>
      <a class="sidebar-nav-item"
         href="/rod/publications.html"><i class="fa fa-file fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Publications</a>
      <a class="sidebar-nav-item"
         href="/rod/book.html"><i class="fa fa-book fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Hilbert Book</a>
      <a class="sidebar-nav-item"
         href="/rod/dp15.html"><i class="fa fa-rocket fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;ARC Grant DP150101011</a>
      <a class="sidebar-nav-item"
         href="/rod/resources.html"><i class="fa fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Resources</a>
      <a class="sidebar-nav-item"
         href="/rod/misc.html"><i class="fa fa-briefcase fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Miscellaneous</a>
  </nav>

  <div class="sidebar-item">
     Site Version v1.1.0<br>
     <a href="http://jekyllrb.com">Jekyll</a> with <a href="https://github.com/poole/lanyon">Lanyon</a><br>
     &copy; 2016. All rights reserved.
  </div>
</div>

    <div class="wrap">
      &nbsp;
      <div class="container content">
         <div class="page">
   <h2 class="page-title">Spherical Harmonic Plotting with MATLAB&reg;</h2>
   <span class="post-date">Technical Note &mdash; 6 Aug 2015</span>
   <h3 class="no_toc" id="contents">Contents</h3>

<ul id="markdown-toc">
  <li><a href="#matlabreg-code-codegeneratesphericalharmonicmcodematlabgeneratesphericalharmonicm" id="markdown-toc-matlabreg-code-codegeneratesphericalharmonicmcodematlabgeneratesphericalharmonicm">MATLAB® Code <a href="matlab/generate_spherical_harmonic.m"><code>generate_spherical_harmonic.m</code></a></a></li>
  <li><a href="#matlabreg-code-coderzryrzdegmcodematlabrzryrzdegm" id="markdown-toc-matlabreg-code-coderzryrzdegmcodematlabrzryrzdegm">MATLAB® Code <a href="matlab/RZRYRZdeg.m"><code>RZRYRZdeg.m</code></a></a></li>
  <li><a href="#examples" id="markdown-toc-examples">Examples</a>    <ul>
      <li><a href="#matlabreg-code-codeshex01mcodematlabshex01m" id="markdown-toc-matlabreg-code-codeshex01mcodematlabshex01m">1) MATLAB® Code <a href="matlab/shex_01.m"><code>shex_01.m</code></a></a>        <ul>
          <li><a href="#output-png-figure-mdash-codeshex01pngcodematlabfiguresshex01png" id="markdown-toc-output-png-figure-mdash-codeshex01pngcodematlabfiguresshex01png">Output png figure — <a href="matlab/figures/shex_01.png"><code>shex_01.png</code></a></a></li>
        </ul>
      </li>
      <li><a href="#matlabreg-code-codeshex02mcodematlabshex02m" id="markdown-toc-matlabreg-code-codeshex02mcodematlabshex02m">2) MATLAB® Code <a href="matlab/shex_02.m"><code>shex_02.m</code></a></a>        <ul>
          <li><a href="#output-png-figure-mdash-codeshex02pngcodematlabfiguresshex02png" id="markdown-toc-output-png-figure-mdash-codeshex02pngcodematlabfiguresshex02png">Output png figure — <a href="matlab/figures/shex_02.png"><code>shex_02.png</code></a></a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#downloads" id="markdown-toc-downloads">Downloads</a></li>
</ul>

<hr style="opacity: 0.5" />

<h3 id="matlabreg-code-codegeneratesphericalharmonicmcodematlabgeneratesphericalharmonicm">MATLAB® Code <a href="matlab/generate_spherical_harmonic.m"><code>generate_spherical_harmonic.m</code></a></h3>

<p>Note that the spherical harmonic is not normalized since we are interested in the shape and not the scaling.</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="k">function</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">yyhat</span><span class="p">,</span><span class="n">name</span><span class="p">]</span><span class="o">=</span> <span class="n">generate_spherical_harmonic</span><span class="p">(</span> <span class="n">degree</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">,</span> <span class="n">rho_ref</span><span class="p">,</span> <span class="n">rho_scale</span><span class="p">,</span> <span class="nb">alpha</span><span class="p">,</span> <span class="nb">beta</span><span class="p">,</span> <span class="nb">gamma</span><span class="p">,</span> <span class="n">numt</span><span class="p">,</span> <span class="n">nump</span> <span class="p">)</span>
<span class="c1">%GENERATE_SPHERICAL_HARMONIC computes a mesh for a spherical harmonic</span>
<span class="c1">%   degree - non-negative integer</span>
<span class="c1">%   order - non-negative integer between 0 and degree (these are real spherical harmonics</span>
<span class="c1">%   type - 0 means the cos type or real type, 1 means the sin type or image type</span>
<span class="c1">%   theta1/theta2 start/end theta of patch (theta2&lt;theta1 is permitted)</span>
<span class="c1">%   phi1/phi2 start/end phi of patch (phi2&lt;phi1 is permitted)</span>
<span class="c1">%   rho_ref - radius of reference sphere; try 0.0 or 1.0</span>
<span class="c1">%   rho_scale - multiplier for normalised (max(abs())=1) spherical harmonic; try 1.25 or 0.25</span>
<span class="c1">%   alpha - third rotation in radians about z-axis</span>
<span class="c1">%   beta - second rotation in radians about y-axis</span>
<span class="c1">%   gamma - first rotation in radians about z-axis</span>
<span class="c1">%   numt - grid size theta</span>
<span class="c1">%   nump - grid size phi</span>

	<span class="c1">% Map degree and order to valid ranges</span>
	<span class="n">degree</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">degree</span><span class="p">);</span>
	<span class="n">order</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">order</span><span class="p">),</span><span class="n">degree</span><span class="p">);</span>

	<span class="c1">% Create the standard uniform grid in both angles</span>
	<span class="n">theta3</span><span class="o">=</span><span class="nb">linspace</span><span class="p">(</span><span class="n">theta1</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="mi">180</span><span class="p">,</span><span class="n">theta2</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="mi">180</span><span class="p">,</span><span class="n">numt</span><span class="p">);</span>
	<span class="n">phi3</span><span class="o">=</span><span class="nb">linspace</span><span class="p">(</span><span class="n">phi1</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="mi">180</span><span class="p">,</span><span class="n">phi2</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="mi">180</span><span class="p">,</span><span class="n">nump</span><span class="p">);</span>
	<span class="p">[</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span><span class="o">=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="n">theta3</span><span class="p">,</span><span class="n">phi3</span><span class="p">);</span>
	
	<span class="c1">% Calculate the bank of Legendre functions (of all orders)</span>
	<span class="n">Ylm</span><span class="o">=</span><span class="nb">legendre</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span><span class="nb">cos</span><span class="p">(</span><span class="n">theta3</span><span class="p">));</span>
	<span class="k">if</span> <span class="n">degree</span><span class="o">==</span><span class="mi">0</span>
		<span class="n">Ylm</span><span class="o">=</span><span class="n">Ylm</span><span class="o">'</span><span class="p">;</span> <span class="c1">% thanks a lot matlab</span>
	<span class="k">end</span>
	
	<span class="c1">% pull out the associated Legendre function of the desired order</span>
	<span class="n">Ylm</span><span class="o">=</span><span class="n">Ylm</span><span class="p">(</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">,:);</span> <span class="c1">% row of the desired order </span>
	<span class="n">yy</span><span class="o">=</span><span class="nb">kron</span><span class="p">(</span><span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">phi3</span><span class="o">'</span><span class="p">)),</span><span class="n">Ylm</span><span class="p">);</span> <span class="c1">% repeat this row ready for multiplying with mesh phi term</span>

	<span class="c1">% construct the SH</span>
	<span class="k">if</span> <span class="nb">type</span><span class="o">==</span><span class="mi">0</span> <span class="c1">% real part</span>
		<span class="n">yy</span><span class="o">=</span><span class="n">yy</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">order</span><span class="o">*</span><span class="n">phi</span><span class="p">);</span>
	<span class="k">elseif</span> <span class="nb">type</span><span class="o">==</span><span class="mi">1</span> <span class="c1">% imag part</span>
		<span class="n">yy</span><span class="o">=</span><span class="n">yy</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">order</span><span class="o">*</span><span class="n">phi</span><span class="p">);</span>
	<span class="k">end</span>

	<span class="c1">% normalize SH so that it has values in range [-1,+1]</span>
	<span class="n">yymax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">yy</span><span class="p">)));</span>
	<span class="k">if</span> <span class="n">yymax</span><span class="o">==</span><span class="mi">0</span> <span class="c1">% zero function</span>
		<span class="n">yyhat</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">yy</span><span class="p">));</span>
	<span class="k">else</span>
		<span class="n">yyhat</span><span class="o">=</span><span class="n">yy</span><span class="p">/</span><span class="n">yymax</span><span class="p">;</span>
    <span class="k">end</span>
    
	<span class="c1">% map the SH value to the radial (height) value</span>
	<span class="n">rho_scale</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">rho_scale</span><span class="p">,</span><span class="mf">0.005</span><span class="p">);</span> <span class="c1">% not too small</span>
	<span class="n">rhoabs</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho_ref</span><span class="o">+</span><span class="n">rho_scale</span><span class="o">*</span><span class="n">yyhat</span><span class="p">);</span>

	<span class="c1">% Apply spherical coordinate equations</span>
	<span class="n">x</span><span class="o">=</span><span class="n">rhoabs</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span>
	<span class="n">y</span><span class="o">=</span><span class="n">rhoabs</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span>
	<span class="n">z</span><span class="o">=</span><span class="n">rhoabs</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span>

	<span class="c1">% rotate the mesh according to zyz Euler rotation</span>
	<span class="n">R</span><span class="o">=</span><span class="n">RZRYRZdeg</span><span class="p">(</span><span class="nb">alpha</span><span class="p">,</span><span class="nb">beta</span><span class="p">,</span><span class="nb">gamma</span><span class="p">);</span>
	<span class="n">Rxyz</span><span class="o">=</span><span class="n">R</span><span class="o">*</span><span class="p">[</span><span class="n">x</span><span class="p">(:)</span> <span class="n">y</span><span class="p">(:)</span> <span class="n">z</span><span class="p">(:)]</span><span class="o">'</span><span class="p">;</span> <span class="c1">% vectorize mesh matrices</span>
	<span class="c1">% refill mesh matrices from vector answer Rxyz</span>
	<span class="n">x</span><span class="p">(:)</span><span class="o">=</span><span class="n">Rxyz</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span><span class="o">'</span><span class="p">;</span>
	<span class="n">y</span><span class="p">(:)</span><span class="o">=</span><span class="n">Rxyz</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span><span class="o">'</span><span class="p">;</span>
	<span class="n">z</span><span class="p">(:)</span><span class="o">=</span><span class="n">Rxyz</span><span class="p">(</span><span class="mi">3</span><span class="p">,:)</span><span class="o">'</span><span class="p">;</span>

	<span class="k">if</span> <span class="nb">type</span><span class="o">==</span><span class="mi">0</span>
		<span class="n">name</span><span class="o">=</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">'%02u-%02u-real'</span><span class="p">,</span><span class="n">degree</span><span class="p">,</span> <span class="n">order</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">name</span><span class="o">=</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">'%02u-%02u-imag'</span><span class="p">,</span><span class="n">degree</span><span class="p">,</span> <span class="n">order</span><span class="p">);</span>
	<span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<h3 id="matlabreg-code-coderzryrzdegmcodematlabrzryrzdegm">MATLAB® Code <a href="matlab/RZRYRZdeg.m"><code>RZRYRZdeg.m</code></a></h3>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="k">function</span> <span class="p">[</span> <span class="n">R</span> <span class="p">]</span> <span class="o">=</span> <span class="n">RZRYRZdeg</span><span class="p">(</span> <span class="nb">alpha</span><span class="p">,</span> <span class="nb">beta</span><span class="p">,</span> <span class="nb">gamma</span> <span class="p">)</span>
<span class="c1">%RZRYRZDEG Generates the 3x3 'zyz' matrix corresponding the Euler angles</span>
<span class="c1">%   arguments in deg</span>
<span class="c1">%   gamma is the first rotation about the z-axis</span>
<span class="c1">%   beta is the second rotation about the y-axis</span>
<span class="c1">%   alpha is the third rotation about the z-axis</span>
	<span class="nb">alpha</span><span class="o">=</span><span class="nb">alpha</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="mi">180</span><span class="p">;</span>
	<span class="nb">beta</span><span class="o">=</span><span class="nb">beta</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="mi">180</span><span class="p">;</span>
	<span class="nb">gamma</span><span class="o">=</span><span class="nb">gamma</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="mi">180</span><span class="p">;</span>
	<span class="n">Rz1</span><span class="o">=</span><span class="p">[</span><span class="nb">cos</span><span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="o">-</span><span class="nb">sin</span><span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">sin</span><span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="nb">cos</span><span class="p">(</span><span class="nb">gamma</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">Ry</span><span class="o">=</span><span class="p">[</span><span class="nb">cos</span><span class="p">(</span><span class="nb">beta</span><span class="p">)</span> <span class="mi">0</span> <span class="nb">sin</span><span class="p">(</span><span class="nb">beta</span><span class="p">);</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">;</span> <span class="o">-</span><span class="nb">sin</span><span class="p">(</span><span class="nb">beta</span><span class="p">)</span> <span class="mi">0</span> <span class="nb">cos</span><span class="p">(</span><span class="nb">beta</span><span class="p">)];</span>
	<span class="n">Rz2</span><span class="o">=</span><span class="p">[</span><span class="nb">cos</span><span class="p">(</span><span class="nb">alpha</span><span class="p">)</span> <span class="o">-</span><span class="nb">sin</span><span class="p">(</span><span class="nb">alpha</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">sin</span><span class="p">(</span><span class="nb">alpha</span><span class="p">)</span> <span class="nb">cos</span><span class="p">(</span><span class="nb">alpha</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">R</span><span class="o">=</span><span class="n">Rz2</span><span class="o">*</span><span class="n">Ry</span><span class="o">*</span><span class="n">Rz1</span><span class="p">;</span>
<span class="k">end</span></code></pre></figure>

<h3 id="examples">Examples</h3>

<p>Here we demonstrate some uses of the above MATLAB® functions.</p>

<h4 id="matlabreg-code-codeshex01mcodematlabshex01m">1) MATLAB® Code <a href="matlab/shex_01.m"><code>shex_01.m</code></a></h4>

<p>Here we pick one spherical harmonic corresponding to <script type="math/tex">\ell=8</script> and <script type="math/tex">m=7</script> and plot it without rotation (on the left) and with a rotation through Euler angles (in degree) <script type="math/tex">\alpha=270</script>, <script type="math/tex">\beta=45</script> and <script type="math/tex">\gamma=0</script> (on the right).  The rotation is achieved by rotating the mesh.</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="k">function</span> <span class="p">[]</span><span class="o">=</span><span class="n">shex_01</span><span class="p">()</span>
    <span class="nb">set</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="s1">'PaperUnits'</span><span class="p">,</span><span class="s1">'inches'</span><span class="p">,</span><span class="s1">'PaperPosition'</span><span class="p">,[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">10</span> <span class="mi">5</span><span class="p">])</span> <span class="c1">%150dpi</span>
    <span class="nb">colormap</span><span class="p">(</span><span class="s1">'copper'</span><span class="p">)</span>
    <span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plonk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plonk</span><span class="p">(</span><span class="mi">270</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span> <span class="s1">'figures/shex_01'</span><span class="p">,</span> <span class="s1">'png'</span><span class="p">)</span>
    <span class="nb">shg</span>
<span class="k">end</span>

<span class="k">function</span> <span class="p">[]</span><span class="o">=</span><span class="n">plonk</span><span class="p">(</span><span class="nb">alpha</span><span class="p">,</span><span class="nb">beta</span><span class="p">,</span><span class="nb">gamma</span><span class="p">)</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">name</span><span class="p">]</span><span class="o">=</span> <span class="n">generate_spherical_harmonic</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="k">...</span>
        <span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">alpha</span><span class="p">,</span><span class="nb">beta</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">96</span><span class="p">);</span>
    <span class="n">s</span><span class="o">=</span><span class="nb">surf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">);</span>
    <span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="s1">'LineWidth'</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="nb">light</span>               <span class="c1">% add a light</span>
    <span class="nb">lighting</span> <span class="n">gouraud</span>    <span class="c1">% preferred lighting for a curved surface</span>
    <span class="nb">lightangle</span><span class="p">(</span><span class="mi">260</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span> <span class="c1">% second fill-in light</span>
    <span class="n">maxa</span><span class="o">=</span><span class="mf">1.8</span><span class="p">;</span>
    <span class="nb">axis</span><span class="p">([</span><span class="o">-</span><span class="n">maxa</span> <span class="n">maxa</span> <span class="o">-</span><span class="n">maxa</span> <span class="n">maxa</span> <span class="o">-</span><span class="n">maxa</span> <span class="n">maxa</span><span class="p">])</span>
    <span class="nb">axis</span> <span class="n">off</span>
    <span class="c1">%set(s, 'edgecolor', 'none');</span>
    <span class="nb">camzoom</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>

<h5 id="output-png-figure-mdash-codeshex01pngcodematlabfiguresshex01png">Output png figure — <a href="matlab/figures/shex_01.png"><code>shex_01.png</code></a></h5>

<p><img src="matlab/figures/shex_01.png" alt="png" width="750px" class="matlab" /></p>

<h4 id="matlabreg-code-codeshex02mcodematlabshex02m">2) MATLAB® Code <a href="matlab/shex_02.m"><code>shex_02.m</code></a></h4>

<p>Here we overlay patches of a spherical harmonic on a transparent sphere.</p>

<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="k">function</span> <span class="p">[]</span><span class="o">=</span><span class="n">shex_02</span><span class="p">()</span>
    <span class="nb">clf</span><span class="p">;</span>
    <span class="nb">colormap</span><span class="p">(</span><span class="s1">'copper'</span><span class="p">)</span>

    <span class="c1">% transparent sphere</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="o">~</span><span class="p">]</span><span class="o">=</span><span class="n">generate_spherical_harmonic</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span><span class="mi">192</span><span class="p">);</span>
    <span class="nb">surf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="s1">'edgecolor'</span><span class="p">,</span><span class="s1">'none'</span><span class="p">,</span><span class="s1">'facealpha'</span><span class="p">,</span><span class="s1">'0.3'</span><span class="p">);</span>

    <span class="c1">% setup scene</span>
    <span class="nb">light</span>               <span class="c1">% add a light</span>
    <span class="nb">lightangle</span><span class="p">(</span><span class="mi">260</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span> <span class="c1">% second fill-in light</span>
    <span class="nb">lighting</span> <span class="n">gouraud</span>    <span class="c1">% preferred lighting for a curved surface</span>
    <span class="nb">axis</span> <span class="n">equal</span> <span class="n">off</span>      <span class="c1">% set axis equal and remove axis</span>
    <span class="nb">view</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>        <span class="c1">% set viewpoint</span>
    <span class="nb">camzoom</span><span class="p">(</span><span class="mf">1.7</span><span class="p">)</span>         
    <span class="nb">hold</span> <span class="n">on</span>

    <span class="c1">% add a patch</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="o">~</span><span class="p">]</span><span class="o">=</span><span class="n">generate_spherical_harmonic</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span><span class="mi">192</span><span class="p">);</span>
    <span class="nb">surf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="s1">'edgecolor'</span><span class="p">,</span><span class="s1">'none'</span><span class="p">);</span>

    <span class="c1">% add a patch</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="o">~</span><span class="p">]</span><span class="o">=</span><span class="n">generate_spherical_harmonic</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span><span class="mi">192</span><span class="p">);</span>
    <span class="nb">surf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="s1">'edgecolor'</span><span class="p">,</span><span class="s1">'none'</span><span class="p">);</span>

    <span class="nb">set</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="s1">'PaperUnits'</span><span class="p">,</span><span class="s1">'inches'</span><span class="p">,</span><span class="s1">'PaperPosition'</span><span class="p">,[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">6</span> <span class="mi">6</span><span class="p">])</span> <span class="c1">%150dpi</span>
    <span class="nb">saveas</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="s1">'figures/shex_02'</span><span class="p">,</span><span class="s1">'png'</span><span class="p">)</span>

    <span class="nb">hold</span> <span class="n">off</span><span class="p">;</span> <span class="nb">shg</span>
<span class="k">end</span></code></pre></figure>

<h5 id="output-png-figure-mdash-codeshex02pngcodematlabfiguresshex02png">Output png figure — <a href="matlab/figures/shex_02.png"><code>shex_02.png</code></a></h5>

<p><img src="matlab/figures/shex_02.png" alt="png" width="450px" class="matlab" /></p>

<h3 id="downloads">Downloads</h3>

<ul>
  <li><a href="matlab/generate_spherical_harmonic.m"><code>generate_spherical_harmonic.m</code></a></li>
  <li><a href="matlab/RZRYRZdeg.m"><code>RZRYRZdeg.m</code></a></li>
  <li><a href="matlab/shex_01.m"><code>shex_01.m</code></a></li>
  <li><a href="matlab/figures/shex_01.png"><code>shex_01.png</code></a></li>
  <li><a href="matlab/shex_02.m"><code>shex_02.m</code></a></li>
  <li><a href="matlab/figures/shex_02.png"><code>shex_02.png</code></a></li>
</ul>

   <hr style="opacity: 0.5">
   
   <h3 id="code-index">Code Index:</h3>
      <ul>
         <li><small><code>[06 Sep 2016]</code></small> &mdash;
            <a href="/rod/resources/p-matlablatex.html">Latex labels with MATLAB&reg;</a></li>
         <li><small><code>[21 Jul 2015]</code></small> &mdash;
            <a href="/rod/resources/p-tikz-external-png.html">TikZ&ndash;tikzexternalize to png</a></li>
         <li><small><code>[18 Jul 2015]</code></small> &mdash;
            <a href="/rod/resources/p-sp-latex.html">Spherical Harmonics LaTeX Macros</a></li>
         <li><small><code>[01 Aug 2015]</code></small> &mdash;
            <a href="/rod/resources/p-bibdeskexport.html">BibDesk Publication html Export</a></li>
      </ul>
      
   <h3 id="sphere-index">Sphere Index:</h3>
      <ul>
         <li><small><code>[06 Aug 2015]</code></small> &mdash; Spherical Harmonic Plotting with MATLAB&reg; </li>
         <li><small><code>[18 Jul 2015]</code></small> &mdash;
            <a href="/rod/resources/p-sp-latex.html">Spherical Harmonics LaTeX Macros</a></li>
         <li><small><code>[16 Jul 2015]</code></small> &mdash;
            <a href="/rod/resources/p-shplot.html">Spherical Harmonic MATLAB&reg; Code 1</a></li>
      </ul>
      
   <h3 id="misc-index">Misc Index:</h3>
      <ul>
         <li><small><code>[31 Jul 2015]</code></small> &mdash;
            <a href="/rod/resources/p-ornament.html">Outputing png from pgfornament</a></li>
         <li><small><code>[18 Jul 2015]</code></small> &mdash;
            <a href="/rod/resources/p-gaussleg.html">Improving Gauss-Legendre</a></li>
      </ul>
      
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
         var toggle = document.querySelector('.sidebar-toggle');
         var sidebar = document.querySelector('#sidebar');
         var checkbox = document.querySelector('#sidebar-checkbox');

         document.addEventListener('click', function(e) {
            var target = e.target;
            if(!checkbox.checked || sidebar.contains(target) ||
               (target === checkbox || target === toggle)) return;

            checkbox.checked = false;
         }, false);
         })(document);
      </script>
   </body>
</html>
